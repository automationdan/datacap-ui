{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\n\nvar _ComposedModal$propTy;\n\nvar _excluded = [\"aria-labelledby\", \"aria-label\", \"children\", \"className\", \"containerClassName\", \"danger\", \"onClose\", \"onKeyDown\", \"open\", \"preventCloseOnClickOutside\", \"selectorPrimaryFocus\", \"selectorsFloatingMenus\", \"size\"];\nimport React, { useRef, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { ModalHeader } from './ModalHeader';\nimport { ModalFooter } from '../ComposedModal';\nimport classNames from 'classnames';\nimport toggleClass from '../../../tools/toggleClass';\nimport wrapFocus from '../../../internal/wrapFocus';\nimport { usePrefix } from '../../../internal/usePrefix';\nvar ComposedModal = /*#__PURE__*/React.forwardRef(function ComposedModal(_ref, ref) {\n  var _classNames, _classNames2;\n\n  var ariaLabelledBy = _ref['aria-labelledby'],\n      ariaLabel = _ref['aria-label'],\n      children = _ref.children,\n      className = _ref.className,\n      containerClassName = _ref.containerClassName,\n      danger = _ref.danger,\n      onClose = _ref.onClose,\n      onKeyDown = _ref.onKeyDown,\n      open = _ref.open,\n      preventCloseOnClickOutside = _ref.preventCloseOnClickOutside,\n      selectorPrimaryFocus = _ref.selectorPrimaryFocus,\n      selectorsFloatingMenus = _ref.selectorsFloatingMenus,\n      size = _ref.size,\n      rest = _objectWithoutProperties(_ref, _excluded);\n\n  var prefix = usePrefix();\n\n  var _useState = useState(open),\n      _useState2 = _slicedToArray(_useState, 2),\n      isOpen = _useState2[0],\n      setisOpen = _useState2[1];\n\n  var _useState3 = useState(open),\n      _useState4 = _slicedToArray(_useState3, 2),\n      prevOpen = _useState4[0],\n      setPrevOpen = _useState4[1];\n\n  var innerModal = useRef();\n  var button = useRef();\n  var startSentinel = useRef();\n  var endSentinel = useRef();\n\n  if (open !== prevOpen) {\n    setisOpen(open);\n    setPrevOpen(open);\n  }\n\n  function handleKeyDown(evt) {\n    // Esc key\n    if (evt.which === 27) {\n      closeModal(evt);\n    }\n\n    onKeyDown(evt);\n  }\n\n  function handleClick(evt) {\n    if (!innerModal.current.contains(evt.target) && preventCloseOnClickOutside) {\n      return;\n    }\n\n    if (innerModal.current && !innerModal.current.contains(evt.target)) {\n      closeModal(evt);\n    }\n  }\n\n  function handleBlur(_ref2) {\n    var oldActiveNode = _ref2.target,\n        currentActiveNode = _ref2.relatedTarget;\n\n    if (open && currentActiveNode && oldActiveNode) {\n      var bodyNode = innerModal.current;\n      var startSentinelNode = startSentinel.current;\n      var endSentinelNode = endSentinel.current;\n      wrapFocus({\n        bodyNode: bodyNode,\n        startSentinelNode: startSentinelNode,\n        endSentinelNode: endSentinelNode,\n        currentActiveNode: currentActiveNode,\n        oldActiveNode: oldActiveNode,\n        selectorsFloatingMenus: selectorsFloatingMenus\n      });\n    }\n  }\n\n  function closeModal(evt) {\n    if (!onClose || onClose(evt) !== false) {\n      setisOpen(false);\n    }\n  }\n\n  var modalClass = classNames((_classNames = {}, _defineProperty(_classNames, \"\".concat(prefix, \"--modal\"), true), _defineProperty(_classNames, 'is-visible', isOpen), _defineProperty(_classNames, className, className), _defineProperty(_classNames, \"\".concat(prefix, \"--modal--danger\"), danger), _classNames));\n  var containerClass = classNames((_classNames2 = {}, _defineProperty(_classNames2, \"\".concat(prefix, \"--modal-container\"), true), _defineProperty(_classNames2, \"\".concat(prefix, \"--modal-container--\").concat(size), size), _defineProperty(_classNames2, containerClassName, containerClassName), _classNames2)); // Generate aria-label based on Modal Header label if one is not provided (L253)\n\n  var generatedAriaLabel;\n  var childrenWithProps = React.Children.toArray(children).map(function (child) {\n    switch (child.type) {\n      case /*#__PURE__*/React.createElement(ModalHeader).type:\n        generatedAriaLabel = child.props.label;\n        return /*#__PURE__*/React.cloneElement(child, {\n          closeModal: closeModal\n        });\n\n      case /*#__PURE__*/React.createElement(ModalFooter).type:\n        return /*#__PURE__*/React.cloneElement(child, {\n          closeModal: closeModal,\n          inputref: button\n        });\n\n      default:\n        return child;\n    }\n  });\n  useEffect(function () {\n    if (prevOpen !== isOpen) {\n      toggleClass(document.body, \"\".concat(prefix, \"--body--with-modal-open\"), isOpen);\n    }\n  });\n  useEffect(function () {\n    return function () {\n      return toggleClass(document.body, \"\".concat(prefix, \"--body--with-modal-open\"), false);\n    };\n  });\n  useEffect(function () {\n    toggleClass(document.body, \"\".concat(prefix, \"--body--with-modal-open\"), open);\n  }, [open, prefix]);\n  useEffect(function () {\n    var focusButton = function focusButton(focusContainerElement) {\n      if (focusContainerElement) {\n        var primaryFocusElement = focusContainerElement.querySelector(selectorPrimaryFocus);\n\n        if (primaryFocusElement) {\n          primaryFocusElement.focus();\n          return;\n        }\n\n        if (button.current) {\n          button.current.focus();\n        }\n      }\n    };\n\n    if (!open) {\n      return;\n    }\n\n    if (innerModal.current) {\n      focusButton(innerModal.current);\n    }\n  }, [open, selectorPrimaryFocus]);\n  return /*#__PURE__*/React.createElement(\"div\", _extends({}, rest, {\n    role: \"presentation\",\n    ref: ref,\n    onBlur: handleBlur,\n    onClick: handleClick,\n    onKeyDown: handleKeyDown,\n    className: modalClass\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    ref: startSentinel,\n    tabIndex: \"0\",\n    role: \"link\",\n    className: \"\".concat(prefix, \"--visually-hidden\")\n  }, \"Focus sentinel\"), /*#__PURE__*/React.createElement(\"div\", {\n    ref: innerModal,\n    className: containerClass,\n    role: \"dialog\",\n    \"aria-modal\": \"true\",\n    \"aria-label\": ariaLabel ? ariaLabel : generatedAriaLabel,\n    \"aria-labelledby\": ariaLabelledBy\n  }, childrenWithProps), /*#__PURE__*/React.createElement(\"span\", {\n    ref: endSentinel,\n    tabIndex: \"0\",\n    role: \"link\",\n    className: \"\".concat(prefix, \"--visually-hidden\")\n  }, \"Focus sentinel\"));\n});\nComposedModal.propTypes = (_ComposedModal$propTy = {}, _defineProperty(_ComposedModal$propTy, 'aria-label', PropTypes.string), _defineProperty(_ComposedModal$propTy, 'aria-labelledby', PropTypes.string), _defineProperty(_ComposedModal$propTy, \"children\", PropTypes.node), _defineProperty(_ComposedModal$propTy, \"className\", PropTypes.string), _defineProperty(_ComposedModal$propTy, \"containerClassName\", PropTypes.string), _defineProperty(_ComposedModal$propTy, \"danger\", PropTypes.bool), _defineProperty(_ComposedModal$propTy, \"onClose\", PropTypes.func), _defineProperty(_ComposedModal$propTy, \"onKeyDown\", PropTypes.func), _defineProperty(_ComposedModal$propTy, \"open\", PropTypes.bool), _defineProperty(_ComposedModal$propTy, \"preventCloseOnClickOutside\", PropTypes.bool), _defineProperty(_ComposedModal$propTy, \"selectorPrimaryFocus\", PropTypes.string), _defineProperty(_ComposedModal$propTy, \"selectorsFloatingMenus\", PropTypes.string), _defineProperty(_ComposedModal$propTy, \"size\", PropTypes.oneOf(['xs', 'sm', 'md', 'lg'])), _ComposedModal$propTy);\nComposedModal.defaultProps = {\n  onKeyDown: function onKeyDown() {},\n  selectorPrimaryFocus: '[data-modal-primary-focus]'\n};\nexport default ComposedModal;","map":{"version":3,"sources":["/Users/danielcrow/Documents/development/cloudfoundry/capture/capture-ui/node_modules/carbon-components-react/es/components/ComposedModal/next/ComposedModal.js"],"names":["_extends","_defineProperty","_slicedToArray","_objectWithoutProperties","_ComposedModal$propTy","_excluded","React","useRef","useEffect","useState","PropTypes","ModalHeader","ModalFooter","classNames","toggleClass","wrapFocus","usePrefix","ComposedModal","forwardRef","_ref","ref","_classNames","_classNames2","ariaLabelledBy","ariaLabel","children","className","containerClassName","danger","onClose","onKeyDown","open","preventCloseOnClickOutside","selectorPrimaryFocus","selectorsFloatingMenus","size","rest","prefix","_useState","_useState2","isOpen","setisOpen","_useState3","_useState4","prevOpen","setPrevOpen","innerModal","button","startSentinel","endSentinel","handleKeyDown","evt","which","closeModal","handleClick","current","contains","target","handleBlur","_ref2","oldActiveNode","currentActiveNode","relatedTarget","bodyNode","startSentinelNode","endSentinelNode","modalClass","concat","containerClass","generatedAriaLabel","childrenWithProps","Children","toArray","map","child","type","createElement","props","label","cloneElement","inputref","document","body","focusButton","focusContainerElement","primaryFocusElement","querySelector","focus","role","onBlur","onClick","tabIndex","propTypes","string","node","bool","func","oneOf","defaultProps"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\n\nvar _ComposedModal$propTy;\n\nvar _excluded = [\"aria-labelledby\", \"aria-label\", \"children\", \"className\", \"containerClassName\", \"danger\", \"onClose\", \"onKeyDown\", \"open\", \"preventCloseOnClickOutside\", \"selectorPrimaryFocus\", \"selectorsFloatingMenus\", \"size\"];\nimport React, { useRef, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { ModalHeader } from './ModalHeader';\nimport { ModalFooter } from '../ComposedModal';\nimport classNames from 'classnames';\nimport toggleClass from '../../../tools/toggleClass';\nimport wrapFocus from '../../../internal/wrapFocus';\nimport { usePrefix } from '../../../internal/usePrefix';\nvar ComposedModal = /*#__PURE__*/React.forwardRef(function ComposedModal(_ref, ref) {\n  var _classNames, _classNames2;\n\n  var ariaLabelledBy = _ref['aria-labelledby'],\n      ariaLabel = _ref['aria-label'],\n      children = _ref.children,\n      className = _ref.className,\n      containerClassName = _ref.containerClassName,\n      danger = _ref.danger,\n      onClose = _ref.onClose,\n      onKeyDown = _ref.onKeyDown,\n      open = _ref.open,\n      preventCloseOnClickOutside = _ref.preventCloseOnClickOutside,\n      selectorPrimaryFocus = _ref.selectorPrimaryFocus,\n      selectorsFloatingMenus = _ref.selectorsFloatingMenus,\n      size = _ref.size,\n      rest = _objectWithoutProperties(_ref, _excluded);\n\n  var prefix = usePrefix();\n\n  var _useState = useState(open),\n      _useState2 = _slicedToArray(_useState, 2),\n      isOpen = _useState2[0],\n      setisOpen = _useState2[1];\n\n  var _useState3 = useState(open),\n      _useState4 = _slicedToArray(_useState3, 2),\n      prevOpen = _useState4[0],\n      setPrevOpen = _useState4[1];\n\n  var innerModal = useRef();\n  var button = useRef();\n  var startSentinel = useRef();\n  var endSentinel = useRef();\n\n  if (open !== prevOpen) {\n    setisOpen(open);\n    setPrevOpen(open);\n  }\n\n  function handleKeyDown(evt) {\n    // Esc key\n    if (evt.which === 27) {\n      closeModal(evt);\n    }\n\n    onKeyDown(evt);\n  }\n\n  function handleClick(evt) {\n    if (!innerModal.current.contains(evt.target) && preventCloseOnClickOutside) {\n      return;\n    }\n\n    if (innerModal.current && !innerModal.current.contains(evt.target)) {\n      closeModal(evt);\n    }\n  }\n\n  function handleBlur(_ref2) {\n    var oldActiveNode = _ref2.target,\n        currentActiveNode = _ref2.relatedTarget;\n\n    if (open && currentActiveNode && oldActiveNode) {\n      var bodyNode = innerModal.current;\n      var startSentinelNode = startSentinel.current;\n      var endSentinelNode = endSentinel.current;\n      wrapFocus({\n        bodyNode: bodyNode,\n        startSentinelNode: startSentinelNode,\n        endSentinelNode: endSentinelNode,\n        currentActiveNode: currentActiveNode,\n        oldActiveNode: oldActiveNode,\n        selectorsFloatingMenus: selectorsFloatingMenus\n      });\n    }\n  }\n\n  function closeModal(evt) {\n    if (!onClose || onClose(evt) !== false) {\n      setisOpen(false);\n    }\n  }\n\n  var modalClass = classNames((_classNames = {}, _defineProperty(_classNames, \"\".concat(prefix, \"--modal\"), true), _defineProperty(_classNames, 'is-visible', isOpen), _defineProperty(_classNames, className, className), _defineProperty(_classNames, \"\".concat(prefix, \"--modal--danger\"), danger), _classNames));\n  var containerClass = classNames((_classNames2 = {}, _defineProperty(_classNames2, \"\".concat(prefix, \"--modal-container\"), true), _defineProperty(_classNames2, \"\".concat(prefix, \"--modal-container--\").concat(size), size), _defineProperty(_classNames2, containerClassName, containerClassName), _classNames2)); // Generate aria-label based on Modal Header label if one is not provided (L253)\n\n  var generatedAriaLabel;\n  var childrenWithProps = React.Children.toArray(children).map(function (child) {\n    switch (child.type) {\n      case /*#__PURE__*/React.createElement(ModalHeader).type:\n        generatedAriaLabel = child.props.label;\n        return /*#__PURE__*/React.cloneElement(child, {\n          closeModal: closeModal\n        });\n\n      case /*#__PURE__*/React.createElement(ModalFooter).type:\n        return /*#__PURE__*/React.cloneElement(child, {\n          closeModal: closeModal,\n          inputref: button\n        });\n\n      default:\n        return child;\n    }\n  });\n  useEffect(function () {\n    if (prevOpen !== isOpen) {\n      toggleClass(document.body, \"\".concat(prefix, \"--body--with-modal-open\"), isOpen);\n    }\n  });\n  useEffect(function () {\n    return function () {\n      return toggleClass(document.body, \"\".concat(prefix, \"--body--with-modal-open\"), false);\n    };\n  });\n  useEffect(function () {\n    toggleClass(document.body, \"\".concat(prefix, \"--body--with-modal-open\"), open);\n  }, [open, prefix]);\n  useEffect(function () {\n    var focusButton = function focusButton(focusContainerElement) {\n      if (focusContainerElement) {\n        var primaryFocusElement = focusContainerElement.querySelector(selectorPrimaryFocus);\n\n        if (primaryFocusElement) {\n          primaryFocusElement.focus();\n          return;\n        }\n\n        if (button.current) {\n          button.current.focus();\n        }\n      }\n    };\n\n    if (!open) {\n      return;\n    }\n\n    if (innerModal.current) {\n      focusButton(innerModal.current);\n    }\n  }, [open, selectorPrimaryFocus]);\n  return /*#__PURE__*/React.createElement(\"div\", _extends({}, rest, {\n    role: \"presentation\",\n    ref: ref,\n    onBlur: handleBlur,\n    onClick: handleClick,\n    onKeyDown: handleKeyDown,\n    className: modalClass\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    ref: startSentinel,\n    tabIndex: \"0\",\n    role: \"link\",\n    className: \"\".concat(prefix, \"--visually-hidden\")\n  }, \"Focus sentinel\"), /*#__PURE__*/React.createElement(\"div\", {\n    ref: innerModal,\n    className: containerClass,\n    role: \"dialog\",\n    \"aria-modal\": \"true\",\n    \"aria-label\": ariaLabel ? ariaLabel : generatedAriaLabel,\n    \"aria-labelledby\": ariaLabelledBy\n  }, childrenWithProps), /*#__PURE__*/React.createElement(\"span\", {\n    ref: endSentinel,\n    tabIndex: \"0\",\n    role: \"link\",\n    className: \"\".concat(prefix, \"--visually-hidden\")\n  }, \"Focus sentinel\"));\n});\nComposedModal.propTypes = (_ComposedModal$propTy = {}, _defineProperty(_ComposedModal$propTy, 'aria-label', PropTypes.string), _defineProperty(_ComposedModal$propTy, 'aria-labelledby', PropTypes.string), _defineProperty(_ComposedModal$propTy, \"children\", PropTypes.node), _defineProperty(_ComposedModal$propTy, \"className\", PropTypes.string), _defineProperty(_ComposedModal$propTy, \"containerClassName\", PropTypes.string), _defineProperty(_ComposedModal$propTy, \"danger\", PropTypes.bool), _defineProperty(_ComposedModal$propTy, \"onClose\", PropTypes.func), _defineProperty(_ComposedModal$propTy, \"onKeyDown\", PropTypes.func), _defineProperty(_ComposedModal$propTy, \"open\", PropTypes.bool), _defineProperty(_ComposedModal$propTy, \"preventCloseOnClickOutside\", PropTypes.bool), _defineProperty(_ComposedModal$propTy, \"selectorPrimaryFocus\", PropTypes.string), _defineProperty(_ComposedModal$propTy, \"selectorsFloatingMenus\", PropTypes.string), _defineProperty(_ComposedModal$propTy, \"size\", PropTypes.oneOf(['xs', 'sm', 'md', 'lg'])), _ComposedModal$propTy);\nComposedModal.defaultProps = {\n  onKeyDown: function onKeyDown() {},\n  selectorPrimaryFocus: '[data-modal-primary-focus]'\n};\nexport default ComposedModal;"]},"metadata":{},"sourceType":"module"}